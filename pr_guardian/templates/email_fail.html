<!DOCTYPE html>
<html lang="fr">
<head><meta charset="UTF-8"><title>PR-Guardian â€” {{ verdict }}</title></head>
<body style="font-family:Arial,sans-serif;max-width:700px;margin:0 auto;padding:20px;">
  <div style="background:#ffebee;border-left:5px solid #f44336;padding:15px;margin-bottom:20px;">
    <h2 style="color:#c62828;margin:0;">{{ "âŒ" if verdict == "FAIL" else "ğŸš«" }} PR #{{ pr_number }} â€” {{ verdict }}</h2>
    <p style="margin:5px 0 0;color:#555;">Score de confiance : {{ confidence_score }}/100</p>
  </div>

  <table style="width:100%;border-collapse:collapse;margin-bottom:15px;">
    <tr><td style="padding:5px;font-weight:bold;width:120px;">Repo</td><td>{{ repo }}</td></tr>
    <tr><td style="padding:5px;font-weight:bold;">Branche</td><td>{{ branch }}</td></tr>
    <tr><td style="padding:5px;font-weight:bold;">Jira</td><td>{{ jira_key }}</td></tr>
  </table>

  <h3>Justification</h3>
  <ul>
    {% for j in justification %}
    <li>{{ j }}</li>
    {% endfor %}
  </ul>

  {% if must_fix %}
  <h3 style="color:#c62828;">ğŸ”§ MUST-FIX</h3>
  <ol>
    {% for mf in must_fix %}
    <li style="margin-bottom:10px;">
      <strong>[{{ mf.severity }}]</strong> {{ mf.description }}<br/>
      <span style="color:#666;">ğŸ“ {{ mf.location }}</span><br/>
      <span style="color:#1565c0;">ğŸ’¡ {{ mf.suggestion }}</span>
    </li>
    {% endfor %}
  </ol>
  {% endif %}

  <h3>Table de Validation</h3>
  <table style="width:100%;border-collapse:collapse;">
    <thead>
      <tr style="background:#f5f5f5;">
        <th style="border:1px solid #ddd;padding:8px;text-align:left;">CatÃ©gorie</th>
        <th style="border:1px solid #ddd;padding:8px;text-align:left;">Item</th>
        <th style="border:1px solid #ddd;padding:8px;text-align:center;">Statut</th>
        <th style="border:1px solid #ddd;padding:8px;text-align:left;">Preuve</th>
      </tr>
    </thead>
    <tbody>
      {% for row in validation_table %}
      <tr>
        <td style="border:1px solid #ddd;padding:8px;">{{ row.category }}</td>
        <td style="border:1px solid #ddd;padding:8px;">{{ row.item }}</td>
        <td style="border:1px solid #ddd;padding:8px;text-align:center;">{{ row.status }}</td>
        <td style="border:1px solid #ddd;padding:8px;">{{ row.evidence }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <hr style="border:none;border-top:1px solid #eee;margin:20px 0;">
  <p style="color:#999;font-size:12px;">PR-Guardian Orchestrator â€” Team7</p>
</body>
</html>
